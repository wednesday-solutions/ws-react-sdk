import{CognitoUserAttribute as e,CognitoUser as n,AuthenticationDetails as t,CognitoUserPool as r}from"amazon-cognito-identity-js";import"antd/lib/message/style";import"antd/lib/message";import"antd/lib/select/style";import o from"antd/lib/select";import"react";import i from"styled-components";function u(e,n,t,r,o,i,u){try{var s=e[i](u),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function s(e){u(i,r,o,s,c,"next",e)}function c(e){u(i,r,o,s,c,"throw",e)}s(void 0)}))}}var c,a,f;!function(){const e={"process.env.AWS_COGNITO_USER_POOL_ID":'"ap-southeast-1_URpT8rFMN"',"process.env.AWS_COGNITO_USER_POOL_APP_CLIENT":'"6uobj0e81bfc2hbo1rjked632r"',NODE_ENV:"production"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}(),o.Option,i.img(c||(a=["\n  margin-right: 10px;\n"],f||(f=a.slice(0)),c=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(f)}}))));var p,m=function(e){return new Promise((function(n,t){return e(n,t)}))};function l(){return g.apply(this,arguments)}function g(){return(g=s(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=A().getCurrentUser(),e.abrupt("return",new Promise((function(e,t){n.getSession((function(r,o){if(r)return t(r);n.getUserAttributes((function(n,r){if(n)return t(n);e(r)}))}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(n,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5?arguments[5]:void 0;return new Promise((function(s,c){var a=new e({Name:"email",Value:n}),f=new e({Name:"custom:group",Value:u?"group-owner":"group-vet"}),p=[];p.push(a),p.push(f),p.push(new e({Name:"custom:business",Value:i.toString()})),p.push(new e({Name:"given_name",Value:r})),p.push(new e({Name:"phone_number",Value:o})),A().signUp(n,t,p,null,(function(e,n){e&&c(e),s(n)}))}))}function P(e,t){return new Promise((function(r,o){var i=A(),u=new n({Username:e,Pool:i});if(null===u){var s=new Error({code:"NotAuthorizedException",message:"No user data is present",name:"NotAuthorizedException"});o(s)}u.confirmRegistration(t,!0,(function(e,n){e&&o(e),r(n)}))}))}function _(e){return new Promise((function(t,r){var o=A(),i=new n({Username:e,Pool:o});if(null===i){var u=new Error({code:"NotAuthorizedException",message:"No user data is present",name:"NotAuthorizedException"});r(u)}i.resendConfirmationCode((function(e,n){e&&r(e),t(n)}))}))}function O(e,r){return new Promise((function(o,i){var u=new t({Username:e,Password:r}),s={Username:e,Pool:A()};new n(s).authenticateUser(u,{onSuccess:function(e){var n=e.getAccessToken().getJwtToken(),t=e.getRefreshToken().token,r=e.idToken.jwtToken;o({payload:{accessToken:n,refreshToken:t,idToken:r}})},onFailure:function(e){i(e)}})}))}function h(){return v.apply(this,arguments)}function v(){return(v=s(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=A().getCurrentUser())){e.next=3;break}throw new Error({code:"NotAuthorizedException",message:"No user is logged in",name:"NotAuthorizedException"});case 3:return e.next=5,m((function(e,t){n.getSession((function(n,r){if(n)return t(n);if(!r.isValid()){var o=new Error("Session not Valid");return t(o)}e()}))}));case 5:return e.abrupt("return",m((function(e,t){n.getUserAttributes((function(n,r){n&&t(n);for(var o={},i=0;i<r.length;i++)o[r[i].getName()]=r[i].getValue();e(o)}))})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return new Promise((function(e,n){var t=A().getCurrentUser();null===t&&e("No user was signed in");var r=t.getUsername();t.signOut(),e("User: ".concat(r," has been signed out"))}))}function w(e){return new Promise((function(t,r){var o={Username:e,Pool:A()};new n(o).forgotPassword({onSuccess:function(e){t(e)},onFailure:function(e){r(e)}})}))}function E(e,t,r){var o=new n({Username:e,Pool:A()});return new Promise((function(e,n){o.confirmPassword(t,r,{onSuccess:function(n){e(n)},onFailure:function(e){n(e)}})}))}function U(e,n){return b.apply(this,arguments)}function b(){return(b=s(regeneratorRuntime.mark((function e(n,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){I().then((function(r){return r.updateAttributes([{Name:"phone_number",Value:t}],(function(t,o){t||r.getAttributeVerificationCode("phone_number",{onSuccess:function(){},onFailure:function(e){n(e)},inputVerificationCode:function(n){e(n)}})}))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,n){return new Promise((function(e,t){I().then((function(r){return r.verifyAttribute("phone_number",n,{onSuccess:function(n){return e(n)},onFailure:function(e){return t(e)}})}))}))}function A(){if(!p){var e={UserPoolId:process.env.AWS_COGNITO_USER_POOL_ID,ClientId:process.env.AWS_COGNITO_USER_POOL_APP_CLIENT};p=new r(e)}return p}function T(){return process.env.AWS_COGNITO_USER_POOL_ID}function R(){return process.env.AWS_COGNITO_USER_POOL_APP_CLIENT}var S={USER_NOT_CONFIRMED_EXCEPTION:"UserNotConfirmedException",NOT_AUTHORIZED:"NotAuthorizedException",INVALID_PARAMETER_EXCEPTION:"InvalidParameterException",CODE_MISMATCH_EXCEPTION:"CodeMismatchException",USER_NOT_FOUND_EXCEPTION:"UserNotFoundException"},I=function(){var e=A().getCurrentUser();return new Promise((function(n,t){e.getSession((function(r,o){if(r)return t(r);n(e)}))}))},x={COGNITO_ERROR_TYPES:S,getUserPoolAppClient:R,getUserPoolID:T,getUserPool:A,confirmPassword:E,forgotPass:w,getUserAttributes:l,signOut:N,fetchAttributes:h,login:O,resendConfirmationCode:_,confirmSignUp:P,signUp:d,verifyPhoneNumberRequest:C,updatePhoneNumberRequest:U},y=Object.freeze({__proto__:null,getUserAttributes:l,signUp:d,confirmSignUp:P,resendConfirmationCode:_,login:O,fetchAttributes:h,signOut:N,forgotPass:w,confirmPassword:E,updatePhoneNumberRequest:U,verifyPhoneNumberRequest:C,getUserPool:A,getUserPoolID:T,getUserPoolAppClient:R,COGNITO_ERROR_TYPES:S,getCognitoUser:I,default:x});export{y as cognito};
//# sourceMappingURL=services.js.map
