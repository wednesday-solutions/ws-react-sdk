import{CognitoUserAttribute as e,CognitoUser as n,AuthenticationDetails as r,CognitoUserPool as t}from"amazon-cognito-identity-js";import"antd/lib/message/style";import"antd/lib/message";import"antd/lib/select/style";import"antd/lib/select";import"react";import o from"styled-components";function i(e,n,r,t,o,i,s){try{var u=e[i](s),a=u.value}catch(e){return void r(e)}u.done?n(a):Promise.resolve(a).then(t,o)}function s(e){return function(){var n=this,r=arguments;return new Promise((function(t,o){var s=e.apply(n,r);function u(e){i(s,t,o,u,a,"next",e)}function a(e){i(s,t,o,u,a,"throw",e)}u(void 0)}))}}var u,a,c;!function(){const e={};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}(),o.img(u||(a=["\n  margin-right: 10px;\n"],c||(c=a.slice(0)),u=Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(c)}}))));var f,p=e=>new Promise(((n,r)=>e(n,r)));function m(){return l.apply(this,arguments)}function l(){return(l=s((function*(){var e=A().getCurrentUser();return new Promise(((n,r)=>{e.getSession(((t,o)=>{if(t)return r(t);e.getUserAttributes(((e,t)=>{if(e)return r(e);n(t)}))}))}))}))).apply(this,arguments)}function d(n,r,t,o){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;return new Promise(((u,a)=>{var c=new e({Name:"email",Value:n}),f=new e({Name:"custom:group",Value:s?"group-owner":"group-vet"}),p=[];p.push(c),p.push(f),p.push(new e({Name:"custom:business",Value:i.toString()})),p.push(new e({Name:"given_name",Value:t})),p.push(new e({Name:"phone_number",Value:o})),A().signUp(n,r,p,null,(function(e,n){e&&a(e),u(n)}))}))}function g(e,r){return new Promise(((t,o)=>{var i=A(),s=new n({Username:e,Pool:i});if(null===s){var u=new Error({code:"NotAuthorizedException",message:"No user data is present",name:"NotAuthorizedException"});o(u)}s.confirmRegistration(r,!0,(function(e,n){e&&o(e),t(n)}))}))}function P(e){return new Promise(((r,t)=>{var o=A(),i=new n({Username:e,Pool:o});if(null===i){var s=new Error({code:"NotAuthorizedException",message:"No user data is present",name:"NotAuthorizedException"});t(s)}i.resendConfirmationCode((function(e,n){e&&t(e),r(n)}))}))}function v(e,t){return new Promise(((o,i)=>{var s=new r({Username:e,Password:t}),u={Username:e,Pool:A()};new n(u).authenticateUser(s,{onSuccess:function(e){var n=e.getAccessToken().getJwtToken(),r=e.getRefreshToken().token,t=e.idToken.jwtToken;o({payload:{accessToken:n,refreshToken:r,idToken:t}})},onFailure:function(e){i(e)}})}))}function h(){return w.apply(this,arguments)}function w(){return(w=s((function*(){var e=A().getCurrentUser();if(null===e)throw new Error({code:"NotAuthorizedException",message:"No user is logged in",name:"NotAuthorizedException"});return yield p(((n,r)=>{e.getSession((function(e,t){if(e)return r(e);if(!t.isValid()){var o=new Error("Session not Valid");return r(o)}n()}))})),p(((n,r)=>{e.getUserAttributes((function(e,t){e&&r(e);for(var o={},i=0;i<t.length;i++)o[t[i].getName()]=t[i].getValue();n(o)}))}))}))).apply(this,arguments)}function N(){return new Promise(((e,n)=>{var r=A().getCurrentUser();null===r&&e("No user was signed in");var t=r.getUsername();r.signOut(),e("User: ".concat(t," has been signed out"))}))}function E(e){return new Promise(((r,t)=>{var o={Username:e,Pool:A()};new n(o).forgotPassword({onSuccess:function(e){r(e)},onFailure:function(e){t(e)}})}))}function O(e,r,t){var o=new n({Username:e,Pool:A()});return new Promise(((e,n)=>{o.confirmPassword(r,t,{onSuccess:function(n){e(n)},onFailure:function(e){n(e)}})}))}function _(e,n){return U.apply(this,arguments)}function U(){return(U=s((function*(e,n){return new Promise(((e,r)=>{I().then((t=>t.updateAttributes([{Name:"phone_number",Value:n}],((n,o)=>{n||t.getAttributeVerificationCode("phone_number",{onSuccess:()=>{},onFailure:e=>{r(e)},inputVerificationCode:n=>{e(n)}})}))))}))}))).apply(this,arguments)}function C(e,n){return new Promise(((e,r)=>{I().then((t=>t.verifyAttribute("phone_number",n,{onSuccess:n=>e(n),onFailure:e=>r(e)})))}))}function A(){if(!f){var e={UserPoolId:process.env.AWS_COGNITO_USER_POOL_ID,ClientId:process.env.AWS_COGNITO_USER_POOL_APP_CLIENT};f=new t(e)}return f}function T(){return process.env.AWS_COGNITO_USER_POOL_ID}function b(){return process.env.AWS_COGNITO_USER_POOL_APP_CLIENT}var S={USER_NOT_CONFIRMED_EXCEPTION:"UserNotConfirmedException",NOT_AUTHORIZED:"NotAuthorizedException",INVALID_PARAMETER_EXCEPTION:"InvalidParameterException",CODE_MISMATCH_EXCEPTION:"CodeMismatchException",USER_NOT_FOUND_EXCEPTION:"UserNotFoundException"},I=()=>{var e=A().getCurrentUser();return new Promise(((n,r)=>{e.getSession(((t,o)=>{if(t)return r(t);n(e)}))}))},y={COGNITO_ERROR_TYPES:S,getUserPoolAppClient:b,getUserPoolID:T,getUserPool:A,confirmPassword:O,forgotPass:E,getUserAttributes:m,signOut:N,fetchAttributes:h,login:v,resendConfirmationCode:P,confirmSignUp:g,signUp:d,verifyPhoneNumberRequest:C,updatePhoneNumberRequest:_};export default y;export{S as COGNITO_ERROR_TYPES,O as confirmPassword,g as confirmSignUp,h as fetchAttributes,E as forgotPass,I as getCognitoUser,m as getUserAttributes,A as getUserPool,b as getUserPoolAppClient,T as getUserPoolID,v as login,P as resendConfirmationCode,N as signOut,d as signUp,_ as updatePhoneNumberRequest,C as verifyPhoneNumberRequest};
